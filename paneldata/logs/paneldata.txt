----------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/miguelportela/Documents/GitHub/R_Training/paneldata/logs/paneldata.txt
  log type:  text
 opened on:  19 Nov 2020, 00:11:46
r; t=0.00 0:11:46

. 
. timer on 1
r; t=0.00 0:11:46

. 
. // # 1. build simulated data: 10000 observations
. 
.         set obs 5000                    //      define the number of observations
number of observations (_N) was 0, now 5,000
r; t=0.00 0:11:46

.         set seed 345567789              //      define the 'seed' in order to be able
r; t=0.00 0:11:46

.                                                         //      to replicate the results
. 
.         // # 1.1. define worker's id and year of observation
. 
.                 gen workerid = int(_n/10.1)+1
r; t=0.00 0:11:46

.                 bysort workerid: gen year = _n
r; t=0.00 0:11:46

. 
.                 sort workerid year
r; t=0.00 0:11:46

.                 xtset workerid year
       panel variable:  workerid (unbalanced)
        time variable:  year, 1 to 11
                delta:  1 unit
r; t=0.03 0:11:46

. 
.         // # 1.2. generate individual's specific effect, ui
. 
.                 bysort workerid (year): gen double ui = runiform() if _n == 1
(4,504 missing values generated)
r; t=0.00 0:11:46

.                          bysort workerid (year): replace ui = ui[_n-1] if _n > 1
(4504 real changes made)
r; t=0.00 0:11:46

. 
.         // # 1.3. build the instrument, q1
. 
.                 bysort workerid (year): gen quarter= int(4*uniform()+1) if _n == 1
(4,504 missing values generated)
r; t=0.00 0:11:46

.                          bysort workerid (year): replace quarter = quarter[_n-1] if _n > 1
(4504 real changes made)
r; t=0.00 0:11:46

. 
.                         gen q1=(quarter==1)
r; t=0.00 0:11:46

. 
.         // # 1.4. build education and experience; education is a function of ui,
.                         // the worker specific effect, as well as the instrument, q1
. 
.                 bysort workerid (year): gen educ= int(16*runiform())*ui if _n == 1
(4,504 missing values generated)
r; t=0.00 0:11:46

.                         bysort workerid (year): replace educ= educ - 3*q1 if _n == 1
(119 real changes made)
r; t=0.00 0:11:46

. 
.                         bysort workerid (year): replace educ = educ[_n-1] + round(runiform()) if _n > 1
(4,504 real changes made)
r; t=0.00 0:11:46

.                                 sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%      -2.1118             -3
 5%    -.1260787             -3
10%     .5240426             -3       Obs               5,000
25%     2.330317      -2.922136       Sum of Wgt.       5,000

50%     4.685726                      Mean           5.193152
                        Largest       Std. Dev.      3.914044
75%     7.689298       18.25217
90%      10.7564       18.30014       Variance       15.31974
95%     12.63449       18.44627       Skewness       .5687296
99%      15.5471       19.44627       Kurtosis       3.003111
r; t=0.00 0:11:46

.                         
.                         egen sd = sd(educ),by(workerid)
(1 missing value generated)
r; t=0.00 0:11:46

.                                 sum sd, detail

                             sd
-------------------------------------------------------------
      Percentiles      Smallest
 1%      .421637              0
 5%     .8232726              0
10%     .9660916              0       Obs               4,999
25%     1.229273              0       Sum of Wgt.       4,999

50%     1.595132                      Mean           1.610723
                        Largest       Std. Dev.      .5084654
75%      1.95789       3.316625
90%     2.299758       3.316625       Variance       .2585371
95%     2.440401       3.316625       Skewness        .006283
99%      2.65832       3.316625       Kurtosis       2.734078
r; t=0.00 0:11:46

.                                 drop sd
r; t=0.00 0:11:46

.                                 
.                                 recode educ min/0 = 0 20/max = 20
(educ: 281 changes made)
r; t=0.00 0:11:46

.                                         sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%     .5240426              0       Obs               5,000
25%     2.330317              0       Sum of Wgt.       5,000

50%     4.685726                      Mean           5.260554
                        Largest       Std. Dev.       3.80712
75%     7.689298       18.25217
90%      10.7564       18.30014       Variance       14.49416
95%     12.63449       18.44627       Skewness       .7024372
99%      15.5471       19.44627       Kurtosis         3.0027
r; t=0.00 0:11:46

. 
.                 bysort workerid (year): gen exper= int(20*uniform()) if _n == 1
(4,504 missing values generated)
r; t=0.00 0:11:46

.                         bysort workerid (year): replace exper = exper[_n-1] + 1 if _n > 1
(4504 real changes made)
r; t=0.00 0:11:46

. 
.                         gen exper2 = exper^2
r; t=0.00 0:11:46

.         
.         // # 1.5. union status
.         
.                 gen union = round(uniform(),1.0)
r; t=0.00 0:11:46

.                         
.                         tab union

      union |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,568       51.36       51.36
          1 |      2,432       48.64      100.00
------------+-----------------------------------
      Total |      5,000      100.00
r; t=0.00 0:11:46

. 
.         // # 1.6. generate the true log wage equation, where the error term is
.                                 // defined by 'uniform()/ln(600)'; 600 is the minimum wage
.         
.                 gen double lnwage = ln(600) + 0.06*educ + 0.007*exper - 0.00001*exper2 ///
>                                                         + 0.02*year + ui + uniform()/ln(600)
r; t=0.00 0:11:46

. 
.                         gen wage = exp(lnwage)
r; t=0.00 0:11:46

.                         
.                         egen nobs = count(workerid),by(workerid)
r; t=0.00 0:11:46

.                                 tab nobs

       nobs |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.02        0.02
         10 |      4,460       89.20       89.22
         11 |        539       10.78      100.00
------------+-----------------------------------
      Total |      5,000      100.00
r; t=0.00 0:11:46

.                                         drop if nobs < 10
(1 observation deleted)
r; t=0.00 0:11:46

.                                         
.                                                 drop nobs
r; t=0.00 0:11:46

. tab year

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495        9.90        9.90
          2 |        495        9.90       19.80
          3 |        495        9.90       29.71
          4 |        495        9.90       39.61
          5 |        495        9.90       49.51
          6 |        495        9.90       59.41
          7 |        495        9.90       69.31
          8 |        495        9.90       79.22
          9 |        495        9.90       89.12
         10 |        495        9.90       99.02
         11 |         49        0.98      100.00
------------+-----------------------------------
      Total |      4,999      100.00
r; t=0.00 0:11:46

. drop if year > 10
(49 observations deleted)
r; t=0.00 0:11:46

. tab year, ge(yy)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495       10.00       10.00
          2 |        495       10.00       20.00
          3 |        495       10.00       30.00
          4 |        495       10.00       40.00
          5 |        495       10.00       50.00
          6 |        495       10.00       60.00
          7 |        495       10.00       70.00
          8 |        495       10.00       80.00
          9 |        495       10.00       90.00
         10 |        495       10.00      100.00
------------+-----------------------------------
      Total |      4,950      100.00
r; t=0.00 0:11:46

. 
.         sort workerid year
r; t=0.00 0:11:46

.         xtset workerid year
       panel variable:  workerid (strongly balanced)
        time variable:  year, 1 to 10
                delta:  1 unit
r; t=0.00 0:11:46

.         
.         gen lag_lnwage = l.lnwage
(495 missing values generated)
r; t=0.00 0:11:46

. 
.         compress
  variable workerid was float now int
  variable year was float now byte
  variable quarter was float now byte
  variable q1 was float now byte
  variable exper was float now byte
  variable exper2 was float now int
  variable union was float now byte
  (94,050 bytes saved)
r; t=0.00 0:11:46

.         order workerid year ui quarter q1 wage educ exper union exper2 lnwage
r; t=0.00 0:11:46

.         sort workerid year
r; t=0.00 0:11:46

. 
.                                 save ../data/data_simulation, replace
file ../data/data_simulation.dta saved
r; t=0.00 0:11:46

. 
. // # 2. DESCRIPTIVE STATISTICS
. 
.                 describe

Contains data from ../data/data_simulation.dta
  obs:         4,950                          
 vars:            22                          19 Nov 2020 00:11
----------------------------------------------------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
----------------------------------------------------------------------------------------------------------------------------------------
workerid        int     %9.0g                 
year            byte    %9.0g                 
ui              double  %10.0g                
quarter         byte    %9.0g                 
q1              byte    %9.0g                 
wage            float   %9.0g                 
educ            float   %9.0g                 
exper           byte    %9.0g                 
union           byte    %9.0g                 
exper2          int     %9.0g                 
lnwage          double  %10.0g                
yy1             byte    %8.0g                 year== 1.0000
yy2             byte    %8.0g                 year== 2.0000
yy3             byte    %8.0g                 year== 3.0000
yy4             byte    %8.0g                 year== 4.0000
yy5             byte    %8.0g                 year== 5.0000
yy6             byte    %8.0g                 year== 6.0000
yy7             byte    %8.0g                 year== 7.0000
yy8             byte    %8.0g                 year== 8.0000
yy9             byte    %8.0g                 year== 9.0000
yy10            byte    %8.0g                 year== 10.0000
lag_lnwage      float   %9.0g                 
----------------------------------------------------------------------------------------------------------------------------------------
Sorted by: workerid  year
r; t=0.00 0:11:46

.                 codebook, compact

Variable     Obs Unique      Mean       Min       Max  Label
----------------------------------------------------------------------------------------------------------------------------------------
workerid    4950    495       248         1       495  
year        4950     10       5.5         1        10  
ui          4950    495  .4879205  .0004503  .9957856  
quarter     4950      4  2.517172         1         4  
q1          4950      2   .240404         0         1  
wage        4950   4950  1998.779  662.0831  7170.242  
educ        4950   2469  5.226306         0  19.44627  
exper       4950     29  14.33636         0        28  
union       4950      2  .4862626         0         1  
exper2      4950     29  247.2515         0       784  
lnwage      4950   4950  7.483222  6.495391  8.877695  
yy1         4950      2        .1         0         1  year==     1.0000
yy2         4950      2        .1         0         1  year==     2.0000
yy3         4950      2        .1         0         1  year==     3.0000
yy4         4950      2        .1         0         1  year==     4.0000
yy5         4950      2        .1         0         1  year==     5.0000
yy6         4950      2        .1         0         1  year==     6.0000
yy7         4950      2        .1         0         1  year==     7.0000
yy8         4950      2        .1         0         1  year==     8.0000
yy9         4950      2        .1         0         1  year==     9.0000
yy10        4950      2        .1         0         1  year==    10.0000
lag_lnwage  4455   4454  7.454981  6.495391  8.723684  
----------------------------------------------------------------------------------------------------------------------------------------
r; t=0.08 0:11:46

.                 
.                 sum

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    workerid |      4,950         248    142.9083          1        495
        year |      4,950         5.5    2.872571          1         10
          ui |      4,950    .4879205    .2885151   .0004503   .9957856
     quarter |      4,950    2.517172    1.127912          1          4
          q1 |      4,950     .240404     .427372          0          1
-------------+---------------------------------------------------------
        wage |      4,950    1998.779    1032.194   662.0831   7170.242
        educ |      4,950    5.226306    3.794824          0   19.44627
       exper |      4,950    14.33636     6.45977          0         28
       union |      4,950    .4862626    .4998617          0          1
      exper2 |      4,950    247.2515    187.1262          0        784
-------------+---------------------------------------------------------
      lnwage |      4,950    7.483222    .4763188   6.495391   8.877695
         yy1 |      4,950          .1    .3000303          0          1
         yy2 |      4,950          .1    .3000303          0          1
         yy3 |      4,950          .1    .3000303          0          1
         yy4 |      4,950          .1    .3000303          0          1
-------------+---------------------------------------------------------
         yy5 |      4,950          .1    .3000303          0          1
         yy6 |      4,950          .1    .3000303          0          1
         yy7 |      4,950          .1    .3000303          0          1
         yy8 |      4,950          .1    .3000303          0          1
         yy9 |      4,950          .1    .3000303          0          1
-------------+---------------------------------------------------------
        yy10 |      4,950          .1    .3000303          0          1
  lag_lnwage |      4,455    7.454981    .4697752   6.495391   8.723684
r; t=0.00 0:11:46

.                 inspect educ

educ:                                           Number of Observations
-------                                ---------------------------------------
                                             Total      Integers   Nonintegers
|  #                         Negative            -             -             -
|  #                         Zero              333           333             -
|  #   #                     Positive        4,617           205         4,412
|  #   #                               -----------   -----------   -----------
|  #   #   #                 Total           4,950           538         4,412
|  #   #   #   .   .         Missing             -
+----------------------                -----------
0              19.44627                      4,950
(More than 99 unique values)
r; t=0.00 0:11:46

.                 
.                 xtdes

workerid:  1, 2, ..., 495                                    n =        495
    year:  1, 2, ..., 10                                     T =         10
           Delta(year) = 1 unit
           Span(year)  = 10 periods
           (workerid*year uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                        10      10      10        10        10      10      10

     Freq.  Percent    Cum. |  Pattern
 ---------------------------+------------
      495    100.00  100.00 |  1111111111
 ---------------------------+------------
      495    100.00         |  XXXXXXXXXX
r; t=0.04 0:11:46

.                 xtsum

Variable         |      Mean   Std. Dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
workerid overall |       248   142.9083          1        495 |     N =    4950
         between |             143.0385          1        495 |     n =     495
         within  |                    0        248        248 |     T =      10
                 |                                            |
year     overall |       5.5   2.872571          1         10 |     N =    4950
         between |                    0        5.5        5.5 |     n =     495
         within  |             2.872571          1         10 |     T =      10
                 |                                            |
ui       overall |  .4879205   .2885151   .0004503   .9957856 |     N =    4950
         between |             .2887778   .0004503   .9957856 |     n =     495
         within  |             6.72e-17   .4879205   .4879205 |     T =      10
                 |                                            |
quarter  overall |  2.517172   1.127912          1          4 |     N =    4950
         between |             1.128938          1          4 |     n =     495
         within  |                    0   2.517172   2.517172 |     T =      10
                 |                                            |
q1       overall |   .240404    .427372          0          1 |     N =    4950
         between |             .4277611          0          1 |     n =     495
         within  |                    0    .240404    .240404 |     T =      10
                 |                                            |
wage     overall |  1998.779   1032.194   662.0831   7170.242 |     N =    4950
         between |             958.4146   766.2481   5339.549 |     n =     495
         within  |             385.4032   649.9505   3915.021 |     T =      10
                 |                                            |
educ     overall |  5.226306   3.794824          0   19.44627 |     N =    4950
         between |             3.469262          0   15.55874 |     n =     495
         within  |             1.544925   .7263063   9.726306 |     T =      10
                 |                                            |
exper    overall |  14.33636    6.45977          0         28 |     N =    4950
         between |             5.791196        4.5       23.5 |     n =     495
         within  |             2.872571   9.836364   18.83636 |     T =      10
                 |                                            |
union    overall |  .4862626   .4998617          0          1 |     N =    4950
         between |             .1606325          0         .9 |     n =     495
         within  |             .4733982  -.4137374   1.386263 |     T =      10
                 |                                            |
exper2   overall |  247.2515   187.1262          0        784 |     N =    4950
         between |              164.694       28.5      560.5 |     n =     495
         within  |             89.11484   47.75152   470.7515 |     T =      10
                 |                                            |
lnwage   overall |  7.483222   .4763188   6.495391   8.877695 |     N =    4950
         between |             .4451129   6.635227   8.569953 |     n =     495
         within  |             .1706296   7.071283    7.89532 |     T =      10
                 |                                            |
yy1      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy2      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy3      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy4      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy5      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy6      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy7      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy8      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy9      overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
yy10     overall |        .1   .3000303          0          1 |     N =    4950
         between |                    0         .1         .1 |     n =     495
         within  |             .3000303          0          1 |     T =      10
                 |                                            |
lag_ln~e overall |  7.454981   .4697752   6.495391   8.723684 |     N =    4455
         between |             .4441482   6.616816   8.537238 |     n =     495
         within  |              .154193   7.084852   7.870631 |     T =       9
r; t=0.11 0:11:46

.                 
.                         gen educ_int = round(educ,1.0)
r; t=0.00 0:11:46

. 
.         xttab educ_int

                  Overall             Between            Within
 educ_int |    Freq.  Percent      Freq.  Percent        Percent
----------+-----------------------------------------------------
        0 |     491      9.92       135     27.27          36.37
        1 |     394      7.96       199     40.20          19.80
        2 |     447      9.03       245     49.49          18.24
        3 |     563     11.37       278     56.16          20.25
        4 |     519     10.48       290     58.59          17.90
        5 |     495     10.00       279     56.36          17.74
        6 |     425      8.59       247     49.90          17.21
        7 |     339      6.85       207     41.82          16.38
        8 |     310      6.26       177     35.76          17.51
        9 |     251      5.07       149     30.10          16.85
       10 |     180      3.64       118     23.84          15.25
       11 |     140      2.83        90     18.18          15.56
       12 |     133      2.69        67     13.54          19.85
       13 |     109      2.20        57     11.52          19.12
       14 |      63      1.27        40      8.08          15.75
       15 |      42      0.85        22      4.44          19.09
       16 |      26      0.53        14      2.83          18.57
       17 |      15      0.30        12      2.42          12.50
       18 |       7      0.14         7      1.41          10.00
       19 |       1      0.02         1      0.20          10.00
----------+-----------------------------------------------------
    Total |    4950    100.00      2634    532.12          18.79
                               (n = 495)
r; t=0.03 0:11:46

.         xttab union

                  Overall             Between            Within
    union |    Freq.  Percent      Freq.  Percent        Percent
----------+-----------------------------------------------------
        0 |    2543     51.37       495    100.00          51.37
        1 |    2407     48.63       494     99.80          48.72
----------+-----------------------------------------------------
    Total |    4950    100.00       989    199.80          50.05
                               (n = 495)
r; t=0.02 0:11:46

. 
.         xttrans educ_int

           |                                                   educ_int
  educ_int |         0          1          2          3          4          5          6          7          8          9 |     Total
-----------+--------------------------------------------------------------------------------------------------------------+----------
         0 |     73.71      26.29       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         1 |      0.00      50.78      49.22       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         2 |      0.00       0.00      47.09      52.91       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         3 |      0.00       0.00       0.00      52.97      47.03       0.00       0.00       0.00       0.00       0.00 |    100.00 
         4 |      0.00       0.00       0.00       0.00      48.83      51.17       0.00       0.00       0.00       0.00 |    100.00 
         5 |      0.00       0.00       0.00       0.00       0.00      49.32      50.68       0.00       0.00       0.00 |    100.00 
         6 |      0.00       0.00       0.00       0.00       0.00       0.00      48.63      51.37       0.00       0.00 |    100.00 
         7 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00      45.99      54.01       0.00 |    100.00 
         8 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00      49.44      50.56 |    100.00 
         9 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00      48.11 |    100.00 
        10 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        11 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        12 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        13 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        14 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        15 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        16 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        17 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        18 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
-----------+--------------------------------------------------------------------------------------------------------------+----------
     Total |      7.99       7.23       8.78      11.49      10.82      10.24       8.98       7.18       6.46       5.34 |    100.00 


           |                                                   educ_int
  educ_int |        10         11         12         13         14         15         16         17         18         19 |     Total
-----------+--------------------------------------------------------------------------------------------------------------+----------
         0 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         1 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         2 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         3 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         4 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         5 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         6 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         7 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         8 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         9 |     51.89       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        10 |     42.47      57.53       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        11 |      0.00      45.05      54.95       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        12 |      0.00       0.00      56.41      43.59       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        13 |      0.00       0.00       0.00      56.52      43.48       0.00       0.00       0.00       0.00       0.00 |    100.00 
        14 |      0.00       0.00       0.00       0.00      51.11      48.89       0.00       0.00       0.00       0.00 |    100.00 
        15 |      0.00       0.00       0.00       0.00       0.00      58.82      41.18       0.00       0.00       0.00 |    100.00 
        16 |      0.00       0.00       0.00       0.00       0.00       0.00      50.00      50.00       0.00       0.00 |    100.00 
        17 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00      30.00      70.00       0.00 |    100.00 
        18 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00     100.00 |    100.00 
-----------+--------------------------------------------------------------------------------------------------------------+----------
     Total |      3.86       3.01       2.85       2.31       1.41       0.94       0.58       0.34       0.16       0.02 |    100.00 
r; t=0.00 0:11:46

.         xttrans union

           |         union
     union |         0          1 |     Total
-----------+----------------------+----------
         0 |     51.76      48.24 |    100.00 
         1 |     51.62      48.38 |    100.00 
-----------+----------------------+----------
     Total |     51.69      48.31 |    100.00 
r; t=0.00 0:11:46

. 
.                         preserve
r; t=0.00 0:11:46

.                                 collapse (mean) mean_educ = educ (count) educ,by(workerid)
r; t=0.01 0:11:46

.                                 sum mean_educ educ if mean_educ ~= .

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   mean_educ |        495    5.226306    3.469262          0   15.55874
        educ |        495          10           0         10         10
r; t=0.00 0:11:46

.                         restore
r; t=0.00 0:11:46

. 
.                                 tabstat educ,by(union)

Summary for variables: educ
     by categories of: union 

   union |      mean
---------+----------
       0 |  5.332972
       1 |  5.113613
---------+----------
   Total |  5.226306
--------------------
r; t=0.00 0:11:46

.                                 sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%     .5167809              0       Obs               4,950
25%     2.321574              0       Sum of Wgt.       4,950

50%     4.645773                      Mean           5.226306
                        Largest       Std. Dev.      3.794824
75%     7.635435       18.25217
90%     10.69205       18.30014       Variance       14.40069
95%     12.63092       18.44627       Skewness         .71088
99%     15.47818       19.44627       Kurtosis       3.019608
r; t=0.00 0:11:46

.                                         scalar median_educ = r(p50)
r; t=0.00 0:11:46

. 
.         // # 2.1. export descriptive statistics & graphs
. 
.                                         preserve
r; t=0.00 0:11:46

.                                                 set dp comma
r; t=0.00 0:11:46

.                                                         tab year

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495       10,00       10,00
          2 |        495       10,00       20,00
          3 |        495       10,00       30,00
          4 |        495       10,00       40,00
          5 |        495       10,00       50,00
          6 |        495       10,00       60,00
          7 |        495       10,00       70,00
          8 |        495       10,00       80,00
          9 |        495       10,00       90,00
         10 |        495       10,00      100,00
------------+-----------------------------------
      Total |       4950      100,00
r; t=0.00 0:11:46

.                                                                 sum year

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4.950         5,5    2,872571          1         10
r; t=0.00 0:11:46

.                                                                 
.                                                         keep if year == r(max)
(4.455 observations deleted)
r; t=0.00 0:11:46

.                                                         
.                                                         format %12.3f wage educ exper
r; t=0.00 0:11:46

.                                                         
.                                         estpost summarize wage educ exper

             |  e(count)   e(sum_w)    e(mean)     e(Var)      e(sd)     e(min)     e(max)     e(sum) 
-------------+----------------------------------------------------------------------------------------
        wage |       495        495   2552,995    1553284   1246,308   884,9926   7170,242    1263732 
        educ |       495        495   7,455474   14,17742   3,765292          0   19,44627   3690,459 
       exper |       495        495   18,83636   33,53795   5,791196          9         28       9324 
r; t=0.02 0:11:46

.                                         esttab using ../tex_paper/summary_statistics.tex, replace ///
>                                                 cells("count mean sd min max") nonumbers noobs label ///
>                                                 nomtitles nonotes addnotes("Source: own computations.")
(output written to ../tex_paper/summary_statistics.tex)
r; t=0.07 0:11:46

.                                                 
.                                                 set dp period
r; t=0.00 0:11:46

.                                         restore
r; t=0.00 0:11:46

. 
.                                         preserve
r; t=0.00 0:11:46

.                                                 collapse (mean) mean_educ = educ mean_wage = wage,by(year)
r; t=0.00 0:11:46

.                                                 gen ln_mean_wage = ln(mean_wage)
r; t=0.00 0:11:46

.                                                 
.                                                 label var mean_educ "Average education"
r; t=0.00 0:11:46

.                                                 label var ln_mean_wage "Ln Average WAGE"
r; t=0.00 0:11:46

.                                                 
.                                                 sum year

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |         10         5.5     3.02765          1         10
r; t=0.00 0:11:46

.                                                 local mm = r(min)
r; t=0.00 0:11:46

.                                                 local jj = r(max)
r; t=0.00 0:11:46

.                                                 twoway (line mean_educ year, yaxis(1)) || (line ln_mean_wage year, yaxis(2) title("`mm
> ' - `jj'")), ///
>                                                         scheme(sj) title("") graphregion(color(white)) legend(region(color(white)))
r; t=2.72 0:11:49

.                                                         
.                                                         graph export ../tex_paper/figures/mean_education_wage_year.png, replace
(file /Users/miguelportela/Documents/GitHub/R_Training/paneldata/logs/../tex_paper/figures/mean_education_wage_year.png written in PNG f
> ormat)
r; t=0.40 0:11:49

.                                                         graph export ../tex_paper/figures/mean_education_wage_year.eps, replace
(file ../tex_paper/figures/mean_education_wage_year.eps written in EPS format)
r; t=0.01 0:11:49

.                                         restore
r; t=0.00 0:11:49

. 
.                                                 sum year

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,950         5.5    2.872571          1         10
r; t=0.00 0:11:49

.                                                 local mm = r(min)
r; t=0.00 0:11:49

.                                                 local jj = r(max)
r; t=0.00 0:11:49

.                                         
.                                         twoway kdensity lnwage if educ <= median_educ,legend(on label(1 "Low education")) || kdensity 
> lnwage if educ > median_educ, /*
>                                                 */ legend(on label(2 "High education")) title("`mm' - `jj'") scheme(s2mono) graphregio
> n(color(white)) xtitle("Ln GDP") /*
>                                                 */ ytitle("Density") legend(region(lcolor(white))) legend(region(color(white)))
r; t=1.86 0:11:51

. 
.                                                 graph export ../tex_paper/figures/lnwage_education.png, replace                       
>           
(file /Users/miguelportela/Documents/GitHub/R_Training/paneldata/logs/../tex_paper/figures/lnwage_education.png written in PNG format)
r; t=0.82 0:11:52

.                                                 graph export ../tex_paper/figures/lnwage_education.eps, replace
(file ../tex_paper/figures/lnwage_education.eps written in EPS format)
r; t=0.01 0:11:52

. 
. 
. // # 3. REGRESSIONS
. 
.         // # 3.1 OLS
. 
.                 reg lnwage educ exper exper2

      Source |       SS           df       MS      Number of obs   =     4,950
-------------+----------------------------------   F(3, 4946)      =   4816.20
       Model |  836.484454         3  278.828151   Prob > F        =    0.0000
    Residual |  286.342723     4,946  .057893798   R-squared       =    0.7450
-------------+----------------------------------   Adj R-squared   =    0.7448
       Total |  1122.82718     4,949  .226879607   Root MSE        =    .24061

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .1068496   .0009107   117.33   0.000     .1050643    .1086349
       exper |    .012856   .0021981     5.85   0.000     .0085467    .0171654
      exper2 |  -.0002784   .0000759    -3.67   0.000    -.0004272   -.0001295
       _cons |   6.809309   .0150119   453.59   0.000      6.77988    6.838739
------------------------------------------------------------------------------
r; t=0.15 0:11:52

.                 reg lnwage educ exper exper2 i.year ui

      Source |       SS           df       MS      Number of obs   =     4,950
-------------+----------------------------------   F(13, 4936)     =  41579.11
       Model |  1112.66652        13  85.5897325   Prob > F        =    0.0000
    Residual |  10.1606539     4,936  .002058479   R-squared       =    0.9910
-------------+----------------------------------   Adj R-squared   =    0.9909
       Total |  1122.82718     4,949  .226879607   Root MSE        =    .04537

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0603151   .0002231   270.36   0.000     .0598777    .0607524
       exper |   .0071808   .0004214    17.04   0.000     .0063548    .0080069
      exper2 |  -.0000166   .0000145    -1.14   0.254     -.000045    .0000119
             |
        year |
          2  |   .0196232   .0028898     6.79   0.000      .013958    .0252885
          3  |   .0395306   .0029054    13.61   0.000     .0338346    .0452265
          4  |   .0542088   .0029283    18.51   0.000      .048468    .0599496
          5  |    .077908    .002957    26.35   0.000     .0721109    .0837051
          6  |   .0987031   .0029921    32.99   0.000     .0928372    .1045689
          7  |   .1162668   .0030333    38.33   0.000     .1103202    .1222134
          8  |   .1376893   .0030833    44.66   0.000     .1316448    .1437339
          9  |   .1556542   .0031387    49.59   0.000     .1495009    .1618074
         10  |   .1774313   .0032033    55.39   0.000     .1711513    .1837113
             |
          ui |   1.000896   .0027329   366.24   0.000     .9955385    1.006254
       _cons |   6.493085   .0033073  1963.24   0.000     6.486601    6.499569
------------------------------------------------------------------------------
r; t=0.02 0:11:52

. 
.                 reg lnwage educ exper exper2 i.year

      Source |       SS           df       MS      Number of obs   =     4,950
-------------+----------------------------------   F(12, 4937)     =   1202.26
       Model |  836.555976        12   69.712998   Prob > F        =    0.0000
    Residual |  286.271201     4,937  .057984849   R-squared       =    0.7450
-------------+----------------------------------   Adj R-squared   =    0.7444
       Total |  1122.82718     4,949  .226879607   Root MSE        =     .2408

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .1071814   .0009699   110.51   0.000       .10528    .1090829
       exper |   .0130538   .0022348     5.84   0.000     .0086726    .0174349
      exper2 |  -.0002764    .000077    -3.59   0.000    -.0004274   -.0001254
             |
        year |
          2  |  -.0010307   .0153344    -0.07   0.946    -.0310929    .0290315
          3  |  -.0019753   .0154087    -0.13   0.898    -.0321832    .0282325
          4  |  -.0075769    .015516    -0.49   0.625    -.0379952    .0228413
          5  |  -.0041005   .0156491    -0.26   0.793    -.0347797    .0265788
          6  |  -.0048719   .0158093    -0.31   0.758    -.0358651    .0261214
          7  |   -.009027   .0159963    -0.56   0.573    -.0403868    .0223327
          8  |   -.010858    .016222    -0.67   0.503    -.0426603    .0209442
          9  |  -.0132949   .0164776    -0.81   0.420    -.0455983    .0190084
         10  |  -.0108864   .0167811    -0.65   0.517    -.0437847     .022012
             |
       _cons |   6.810622   .0169396   402.05   0.000     6.777413    6.843832
------------------------------------------------------------------------------
r; t=0.02 0:11:52

.                         est store OLS
r; t=0.00 0:11:52

.                         
.         // # 3.2 PANEL
. 
.                 // # 3.2.1 RANDOM EFFECTS
. 
.                         xtreg lnwage educ exper exper2 i.year, re theta

Random-effects GLS regression                   Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.9358                                         min =         10
     between = 0.7200                                         avg =       10.0
     overall = 0.7156                                         max =         10

                                                Wald chi2(12)     =   63374.99
corr(u_i, X)   = 0 (assumed)                    Prob > chi2       =     0.0000
theta          = .93872661

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |    .066613   .0009368    71.11   0.000     .0647769    .0684491
       exper |   .0045286   .0019458     2.33   0.020     .0007148    .0083423
      exper2 |   4.21e-06   .0000199     0.21   0.832    -.0000347    .0000431
             |
        year |
          2  |   .0191379   .0035228     5.43   0.000     .0122334    .0260425
          3  |    .038422     .00484     7.94   0.000     .0289357    .0479083
          4  |   .0524424   .0064624     8.12   0.000     .0397764    .0651084
          5  |   .0753801   .0082121     9.18   0.000     .0592847    .0914754
          6  |   .0951217   .0100298     9.48   0.000     .0754637    .1147797
          7  |   .1115001   .0118837     9.38   0.000     .0882085    .1347917
          8  |   .1314197   .0137676     9.55   0.000     .1044357    .1584037
          9  |   .1481535   .0156547     9.46   0.000     .1174707    .1788362
         10  |   .1687269   .0175498     9.61   0.000       .13433    .2031238
             |
       _cons |   6.985087   .0217757   320.77   0.000     6.942407    7.027767
-------------+----------------------------------------------------------------
     sigma_u |  .23458928
     sigma_e |  .04554041
         rho |  .96368286   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.20 0:11:52

.                                         est store RE
r; t=0.00 0:11:52

.                                 
.                 // # 3.2.2 FIXED EFFECTS
. 
.                         // discuss why some time dummies are dropped
. 
.                         xtreg lnwage educ exper exper2, fe                      // omit the time dummies

Fixed-effects (within) regression               Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.9360                                         min =         10
     between = 0.5415                                         avg =       10.0
     overall = 0.5860                                         max =         10

                                                F(3,4452)         =   21689.90
corr(u_i, Xb)  = 0.1886                         Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0624481   .0009583    65.16   0.000     .0605693    .0643269
       exper |   .0251958   .0007538    33.43   0.000     .0237181    .0266735
      exper2 |   5.45e-06    .000019     0.29   0.774    -.0000318    .0000427
       _cons |   6.794284   .0048313  1406.31   0.000     6.784813    6.803756
-------------+----------------------------------------------------------------
     sigma_u |  .30923658
     sigma_e |  .04552531
         rho |  .97878651   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4452) = 270.66                 Prob > F = 0.0000
r; t=0.05 0:11:52

. 
.                         xtreg lnwage educ exper exper2 i.year, fe       // complete model
note: 10.year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.9360                                         min =         10
     between = 0.5407                                         avg =       10.0
     overall = 0.5854                                         max =         10

                                                F(11,4444)        =    5911.96
corr(u_i, Xb)  = 0.1876                         Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0624152   .0009619    64.89   0.000     .0605295     .064301
       exper |   .0253104   .0008015    31.58   0.000     .0237391    .0268817
      exper2 |   3.55e-06   .0000195     0.18   0.855    -.0000346    .0000417
             |
        year |
          2  |   .0001748    .002753     0.06   0.949    -.0052224     .005572
          3  |   .0005613   .0026483     0.21   0.832    -.0046306    .0057533
          4  |  -.0043192   .0025799    -1.67   0.094    -.0093771    .0007388
          5  |  -.0002396   .0025466    -0.09   0.925    -.0052322     .004753
          6  |   .0008121   .0025459     0.32   0.750     -.004179    .0058033
          7  |  -.0014379   .0025792    -0.56   0.577    -.0064945    .0036187
          8  |   .0000387   .0026471     0.01   0.988    -.0051509    .0052283
          9  |  -.0018782   .0027525    -0.68   0.495    -.0072745    .0035181
         10  |          0  (omitted)
             |
       _cons |   6.793912   .0058888  1153.71   0.000     6.782367    6.805457
-------------+----------------------------------------------------------------
     sigma_u |  .30943273
     sigma_e |  .04554041
         rho |  .97879907   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4444) = 270.45                 Prob > F = 0.0000
r; t=0.04 0:11:52

.                                 est store FE
r; t=0.00 0:11:52

.                                 
.                 // # 3.2.3 HAUSMAN test
. 
.                         hausman FE RE

Note: the rank of the differenced variance matrix (10) does not equal the number of coefficients being tested (11); be sure this is what
        you expect, or there may be problems computing the test.  Examine the output of your estimators for anything unexpected and
        possibly consider scaling your variables so that the coefficients are on a similar scale.

                 ---- Coefficients ----
             |      (b)          (B)            (b-B)     sqrt(diag(V_b-V_B))
             |       FE           RE         Difference          S.E.
-------------+----------------------------------------------------------------
        educ |    .0624152      .066613       -.0041978        .0002182
       exper |    .0253104     .0045286        .0207819               .
      exper2 |    3.55e-06     4.21e-06       -6.61e-07               .
        year |
          2  |    .0001748     .0191379       -.0189631               .
          3  |    .0005613      .038422       -.0378607               .
          4  |   -.0043192     .0524424       -.0567616               .
          5  |   -.0002396     .0753801       -.0756197               .
          6  |    .0008121     .0951217       -.0943096               .
          7  |   -.0014379     .1115001        -.112938               .
          8  |    .0000387     .1314197        -.131381               .
          9  |   -.0018782     .1481535       -.1500317               .
------------------------------------------------------------------------------
                           b = consistent under Ho and Ha; obtained from xtreg
            B = inconsistent under Ha, efficient under Ho; obtained from xtreg

    Test:  Ho:  difference in coefficients not systematic

                 chi2(10) = (b-B)'[(V_b-V_B)^(-1)](b-B)
                          =      311.31
                Prob>chi2 =      0.0000
                (V_b-V_B is not positive definite)
r; t=0.01 0:11:52

. 
.         // # 3.3 IV: cross-section
. 
.                 preserve
r; t=0.00 0:11:52

.                         bysort workerid (year): keep if _n==1           // cross-section
(4,455 observations deleted)
r; t=0.01 0:11:53

.                         
.                         xi: ivreg2 lnwage (educ = q1) exper exper2 i.year, first
i.year            _Iyear_1-1          (naturally coded; _Iyear_1 omitted)

First-stage regressions
-----------------------


First-stage regression of educ:

Statistics consistent for homoskedasticity only
Number of obs =                    495
------------------------------------------------------------------------------
        educ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
          q1 |  -1.925479   .3248022    -5.93   0.000    -2.563652   -1.287305
       exper |  -.1254006   .0924319    -1.36   0.176    -.3070114    .0562103
      exper2 |   .0061944   .0047033     1.32   0.188    -.0030468    .0154355
       _cons |   4.023993    .391794    10.27   0.000     3.254194    4.793793
------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   491) =    35.14
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   491) =    35.14
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   491)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   491)
educ         |      35.14    0.0000 |       35.43   0.0000 |       35.14

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Sanderson-Windmeijer F statistic.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Anderson canon. corr. LM statistic       Chi-sq(1)=33.06    P-val=0.0000

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                      35.14

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,491)=       5.35     P-val=0.0211
Anderson-Rubin Wald test           Chi-sq(1)=      5.39     P-val=0.0202
Stock-Wright LM S statistic        Chi-sq(1)=      5.34     P-val=0.0209

Number of observations               N  =        495
Number of regressors                 K  =          4
Number of endogenous regressors      K1 =          1
Number of instruments                L  =          4
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                                      Number of obs =      495
                                                      F(  3,   491) =     4.59
                                                      Prob > F      =   0.0035
Total (centered) SS     =  94.46239836                Centered R2   =   0.5187
Total (uncentered) SS   =  26033.74243                Uncentered R2 =   0.9983
Residual SS             =  45.46376833                Root MSE      =    .3031

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0550889   .0165682     3.32   0.001     .0226158     .087562
       exper |   .0149673   .0092318     1.62   0.105    -.0031267    .0330613
      exper2 |  -.0005777   .0004694    -1.23   0.218    -.0014976    .0003423
       _cons |   6.994305   .0687991   101.66   0.000     6.859462    7.129149
------------------------------------------------------------------------------
Underidentification test (Anderson canon. corr. LM statistic):          33.063
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):               35.143
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
------------------------------------------------------------------------------
Sargan statistic (overidentification test of all instruments):           0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         educ
Included instruments: exper exper2
Excluded instruments: q1
------------------------------------------------------------------------------
r; t=0.77 0:11:53

.                                 est store IV
r; t=0.00 0:11:53

.                 restore
r; t=0.00 0:11:53

. 
.         // # 3.4 PANEL + IV
. 
.                 // DISCUSS why education is dropped in the following regression
. 
.                 xtivreg lnwage (educ=q1) exper exper2 i.year, fe

Fixed-effects (within) IV regression            Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.8754                                         min =         10
     between = 0.0021                                         avg =       10.0
     overall = 0.0353                                         max =         10

                                                Wald chi2(10)     =   6.87e+07
corr(u_i, Xb)  = -0.5010                        Prob > chi2       =     0.0000

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |          0  (omitted)
       exper |   .0562305   .0008992    62.53   0.000      .054468    .0579929
      exper2 |  -.0000297   .0000272    -1.09   0.275    -.0000829    .0000236
             |
        year |
          2  |  -.0032195   .0038407    -0.84   0.402    -.0107471    .0043082
          3  |  -.0052048   .0036932    -1.41   0.159    -.0124433    .0020338
          4  |  -.0124606   .0035957    -3.47   0.001    -.0195079   -.0054132
          5  |  -.0100738   .0035471    -2.84   0.005     -.017026   -.0031216
          6  |  -.0081666   .0035471    -2.30   0.021    -.0151188   -.0012144
          7  |  -.0085997   .0035957    -2.39   0.017    -.0156471   -.0015524
          8  |  -.0025038   .0036932    -0.68   0.498    -.0097424    .0047348
          9  |  -.0028408   .0038407    -0.74   0.460    -.0103684    .0046869
         10  |          0  (omitted)
             |
       _cons |   6.689723   .0079056   846.20   0.000     6.674228    6.705218
-------------+----------------------------------------------------------------
     sigma_u |  .53655486
     sigma_e |    .063545
         rho |  .98616799   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F  test that all u_i=0:     F(494,4445) =   136.55        Prob > F    = 0.0000
------------------------------------------------------------------------------
Instrumented:   educ
Instruments:    exper exper2 2.year 3.year 4.year 5.year 6.year 7.year 8.year
                9.year 10.year q1
------------------------------------------------------------------------------
r; t=0.65 0:11:54

.                         est store FE_IV
r; t=0.00 0:11:54

.                         
.                 // COMPARE 'ivreg2' & 'xtivreg2, re' results
. 
.                 xtivreg lnwage (educ=q1) exper exper2 i.year, re

G2SLS random-effects IV regression              Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.9355                                         min =         10
     between = 0.7191                                         avg =       10.0
     overall = 0.6881                                         max =         10

                                                Wald chi2(12)     =   55277.92
corr(u_i, X)       = 0 (assumed)                Prob > chi2       =     0.0000

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0562713   .0094353     5.96   0.000     .0377784    .0747642
       exper |   .0045157   .0018387     2.46   0.014     .0009119    .0081194
      exper2 |  -1.47e-06    .000021    -0.07   0.944    -.0000426    .0000397
             |
        year |
          2  |   .0237152   .0054554     4.35   0.000     .0130229    .0344076
          3  |   .0477464   .0096925     4.93   0.000     .0287494    .0667434
          4  |   .0665136   .0142041     4.68   0.000     .0386742    .0943531
          5  |   .0943116   .0188873     4.99   0.000     .0572932      .13133
          6  |   .1193361   .0239579     4.98   0.000     .0723795    .1662927
          7  |    .141157   .0291823     4.84   0.000     .0839607    .1983533
          8  |   .1669838   .0348128     4.80   0.000      .098752    .2352156
          9  |   .1891215   .0400232     4.73   0.000     .1106775    .2675656
         10  |    .214997    .045151     4.76   0.000     .1265027    .3034913
             |
       _cons |   7.018367   .0365398   192.07   0.000      6.94675    7.089984
-------------+----------------------------------------------------------------
     sigma_u |  .29847191
     sigma_e |    .063545
         rho |  .95663856   (fraction of variance due to u_i)
------------------------------------------------------------------------------
Instrumented:   educ
Instruments:    exper exper2 2.year 3.year 4.year 5.year 6.year 7.year 8.year
                9.year 10.year q1
------------------------------------------------------------------------------
r; t=0.14 0:11:54

.                         est store RE_IV
r; t=0.00 0:11:54

. 
.                 // DISCUSS the underlying problems with this exercise
. 
. 
. // # 4. HETEROSKEDASDICITY & SERIAL CORRELATION
. 
.         // # 4.1. test for heteroskedasticity within panel data
. 
.                 // optimal solution proposed by Greene, Econometric Analysis
. 
.                         xtreg lnwage educ exper exper2 i.year, fe
note: 10.year omitted because of collinearity

Fixed-effects (within) regression               Number of obs     =      4,950
Group variable: workerid                        Number of groups  =        495

R-sq:                                           Obs per group:
     within  = 0.9360                                         min =         10
     between = 0.5407                                         avg =       10.0
     overall = 0.5854                                         max =         10

                                                F(11,4444)        =    5911.96
corr(u_i, Xb)  = 0.1876                         Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0624152   .0009619    64.89   0.000     .0605295     .064301
       exper |   .0253104   .0008015    31.58   0.000     .0237391    .0268817
      exper2 |   3.55e-06   .0000195     0.18   0.855    -.0000346    .0000417
             |
        year |
          2  |   .0001748    .002753     0.06   0.949    -.0052224     .005572
          3  |   .0005613   .0026483     0.21   0.832    -.0046306    .0057533
          4  |  -.0043192   .0025799    -1.67   0.094    -.0093771    .0007388
          5  |  -.0002396   .0025466    -0.09   0.925    -.0052322     .004753
          6  |   .0008121   .0025459     0.32   0.750     -.004179    .0058033
          7  |  -.0014379   .0025792    -0.56   0.577    -.0064945    .0036187
          8  |   .0000387   .0026471     0.01   0.988    -.0051509    .0052283
          9  |  -.0018782   .0027525    -0.68   0.495    -.0072745    .0035181
         10  |          0  (omitted)
             |
       _cons |   6.793912   .0058888  1153.71   0.000     6.782367    6.805457
-------------+----------------------------------------------------------------
     sigma_u |  .30943273
     sigma_e |  .04554041
         rho |  .97879907   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4444) = 270.45                 Prob > F = 0.0000
r; t=0.04 0:11:54

.                                 xttest3

Modified Wald test for groupwise heteroskedasticity
in fixed effect regression model

H0: sigma(i)^2 = sigma^2 for all i

chi2 (495)  =   1457.97
Prob>chi2 =      0.0000

r; t=0.03 0:11:54

. 
.         // # 4.2. test for serial correlation within panel data
. 
.                 tab year, gen(yy)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495       10.00       10.00
          2 |        495       10.00       20.00
          3 |        495       10.00       30.00
          4 |        495       10.00       40.00
          5 |        495       10.00       50.00
          6 |        495       10.00       60.00
          7 |        495       10.00       70.00
          8 |        495       10.00       80.00
          9 |        495       10.00       90.00
         10 |        495       10.00      100.00
------------+-----------------------------------
      Total |      4,950      100.00
variable yy1 already defined
r(110); t=0.00 0:11:54

end of do-file

r(110); t=8.67 0:11:54

.       xtabond2 lnwage l.lnwage educ exper exper2 yy3-yy10, gmm(lnwage, lag(2 5)) gmm(educ, lag(2 5)) iv(yy3-yy9) ar(2) small noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.
yy10 dropped due to collinearity

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 59                      Obs per group: min =         8
F(11, 3949)   =   3903.47                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .0053083   .0276971     0.19   0.848    -.0489937    .0596102
             |
        educ |    .081014   .0116912     6.93   0.000     .0580926    .1039354
       exper |  -.0049746   .0172257    -0.29   0.773    -.0387468    .0287975
      exper2 |   .0007077   .0004652     1.52   0.128    -.0002044    .0016198
         yy3 |   .0061155   .0044878     1.36   0.173    -.0026831    .0149142
         yy4 |   .0055703   .0066626     0.84   0.403    -.0074921    .0186328
         yy5 |   .0124215    .008134     1.53   0.127    -.0035257    .0283688
         yy6 |   .0140462   .0085146     1.65   0.099    -.0026472    .0307395
         yy7 |   .0106969   .0079448     1.35   0.178    -.0048793    .0262732
         yy8 |   .0088634   .0063008     1.41   0.160    -.0034898    .0212166
         yy9 |   .0031192   .0043138     0.72   0.470    -.0053382    .0115767
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(yy3 yy4 yy5 yy6 yy7 yy8 yy9)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).educ
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -23.45  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.50  Pr > z =  0.616
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(48)   =  45.17  Prob > chi2 =  0.590
  (Not robust, but not weakened by many instruments.)

Difference-in-Sargan tests of exogeneity of instrument subsets:
  gmm(lnwage, lag(2 5))
    Sargan test excluding group:     chi2(22)   =  18.16  Prob > chi2 =  0.696
    Difference (null H = exogenous): chi2(26)   =  27.01  Prob > chi2 =  0.409
  gmm(educ, lag(2 5))
    Sargan test excluding group:     chi2(22)   =  28.75  Prob > chi2 =  0.152
    Difference (null H = exogenous): chi2(26)   =  16.42  Prob > chi2 =  0.926
  iv(yy3 yy4 yy5 yy6 yy7 yy8 yy9)
    Sargan test excluding group:     chi2(41)   =  42.73  Prob > chi2 =  0.397
    Difference (null H = exogenous): chi2(7)    =   2.43  Prob > chi2 =  0.932

r; t=0.52 0:38:27

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) small noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
F(1, 3959)    =  12906.21                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087396   113.61   0.000      .975729    1.009998
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.10 0:38:43

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
Wald chi2(1)  =  12909.47                                      avg =      8.00
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087385   113.62   0.000     .9757364    1.009991
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.12 0:39:33

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) small noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
F(1, 3959)    =  12906.21                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087396   113.61   0.000      .975729    1.009998
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.08 0:39:37

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
Wald chi2(1)  =  12909.47                                      avg =      8.00
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087385   113.62   0.000     .9757364    1.009991
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.14 0:43:48

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) small noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
F(1, 3959)    =  12906.21                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087396   113.61   0.000      .975729    1.009998
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.11 0:43:54

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) small noleveleq robust
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
F(1, 495)     =  44643.09                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0046991   211.29   0.000     .9836309    1.002096
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -16.92  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   4.55  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   = 235.45  Prob > chi2 =  0.000
  (Robust, but weakened by many instruments.)

r; t=0.11 0:44:06

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) small noleveleq
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
F(1, 3959)    =  12906.21                                      avg =      8.00
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
      lnwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0087396   113.61   0.000      .975729    1.009998
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -29.99  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   5.20  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.08 0:44:24

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) noleveleq robust
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
Wald chi2(1)  =  44733.46                                      avg =      8.00
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0046943   211.50   0.000     .9836628    1.002064
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -16.92  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   4.55  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   = 235.45  Prob > chi2 =  0.000
  (Robust, but weakened by many instruments.)

r; t=0.20 0:45:54

.       xtabond2 lnwage l.lnwage i.year, gmm(lnwage, lag(2 5)) iv(i.year) noleveleq robust
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 34                      Obs per group: min =         8
Wald chi2(11) =   8756.13                                      avg =      8.00
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .0140791   .0389909     0.36   0.718    -.0623417       .0905
             |
        year |
          1  |          0  (empty)
          2  |  -.1003233   .0052001   -19.29   0.000    -.1105154   -.0901313
          3  |  -.0474885   .0037052   -12.82   0.000    -.0547505   -.0402264
          4  |          0  (omitted)
          5  |   .0571468    .003835    14.90   0.000     .0496304    .0646632
          6  |   .1136197   .0056297    20.18   0.000     .1025857    .1246536
          7  |   .1677006   .0076417    21.95   0.000     .1527231     .182678
          8  |   .2282849   .0096777    23.59   0.000     .2093171    .2472528
          9  |    .282286   .0121714    23.19   0.000     .2584306    .3061414
         10  |   .3394969   .0142259    23.86   0.000     .3116146    .3673791
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(1b.year 2.year 3.year 4.year 5.year 6.year 7.year 8.year 9.year
    10.year)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -11.16  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -2.00  Pr > z =  0.045
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(23)   =  56.98  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(23)   =  39.35  Prob > chi2 =  0.018
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(1b.year 2.year 3.year 4.year 5.year 6.year 7.year 8.year 9.year 10.year)
    Hansen test excluding group:     chi2(15)   =  31.02  Prob > chi2 =  0.009
    Difference (null H = exogenous): chi2(8)    =   8.33  Prob > chi2 =  0.402

r; t=0.21 0:50:32

.       xtabond2 lnwage l.lnwage, gmm(lnwage, lag(2 5)) noleveleq robust
Favoring speed over space. To switch, type or click on mata: mata set matafavor space, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      3960
Time variable : year                            Number of groups   =       495
Number of instruments = 26                      Obs per group: min =         8
Wald chi2(1)  =  44733.46                                      avg =      8.00
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
      lnwage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9928635   .0046943   211.50   0.000     .9836628    1.002064
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -16.92  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   4.55  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   = 312.55  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   = 235.45  Prob > chi2 =  0.000
  (Robust, but weakened by many instruments.)

r; t=0.13 0:53:45

